import java.sql.*;

public class StudentController {
    private static final String URL = "jdbc:mysql://localhost:3306/Unexpected";
        private static final String USER = "root";
            private static final String PASSWORD = "Pyrjj2rgo@a1";

                // Add Student to Database
                    public void addStudent(Student student) {
                            String query = "INSERT INTO Students (studentId, name, department, marks) VALUES (?, ?, ?, ?)";

                                    try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD);
                                                 PreparedStatement pstmt = conn.prepareStatement(query)) {

                                                             pstmt.setInt(1, student.getStudentID());  // Ensure studentId matches table
                                                                         pstmt.setString(2, student.getName());
                                                                                     pstmt.setString(3, student.getDepartment());
                                                                                                 pstmt.setDouble(4, student.getMarks());

                                                                                                             pstmt.executeUpdate();
                                                                                                                         System.out.println("✅ Student added successfully.");
                                                                                                                                 } catch (SQLException e) {
                                                                                                                                             System.out.println("❌ Error adding student: " + e.getMessage());
                                                                                                                                                     }
                                                                                                                                                         }

                                                                                                                                                             // View All Students
                                                                                                                                                                 public void viewStudents() {
                                                                                                                                                                         String query = "SELECT * FROM Students";

                                                                                                                                                                                 try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD);
                                                                                                                                                                                              Statement stmt = conn.createStatement();
                                                                                                                                                                                                           ResultSet rs = stmt.executeQuery(query)) {

                                                                                                                                                                                                                       System.out.println("StudentID | Name | Department | Marks");
                                                                                                                                                                                                                                   while (rs.next()) {
                                                                                                                                                                                                                                                   System.out.println(rs.getInt("studentId") + " | " +
                                                                                                                                                                                                                                                                           rs.getString("name") + " | " +
                                                                                                                                                                                                                                                                                                   rs.getString("department") + " | " +
                                                                                                                                                                                                                                                                                                                           rs.getDouble("marks"));
                                                                                                                                                                                                                                                                                                                                       }
                                                                                                                                                                                                                                                                                                                                               } catch (SQLException e) {
                                                                                                                                                                                                                                                                                                                                                           System.out.println("❌ Error retrieving students: " + e.getMessage());
                                                                                                                                                                                                                                                                                                                                                                   }
                                                                                                                                                                                                                                                                                                                                                                       }

                                                                                                                                                                                                                                                                                                                                                                           // Update Student Marks
                                                                                                                                                                                                                                                                                                                                                                               public void updateStudent(int studentID, double marks) {
                                                                                                                                                                                                                                                                                                                                                                                       String query = "UPDATE Students SET marks = ? WHERE studentId = ?";

                                                                                                                                                                                                                                                                                                                                                                                               try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD);
                                                                                                                                                                                                                                                                                                                                                                                                            PreparedStatement pstmt = conn.prepareStatement(query)) {

                                                                                                                                                                                                                                                                                                                                                                                                                        pstmt.setDouble(1, marks);
                                                                                                                                                                                                                                                                                                                                                                                                                                    pstmt.setInt(2, studentID);
                                                                                                                                                                                                                                                                                                                                                                                                                                                int rowsAffected = pstmt.executeUpdate();

                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (rowsAffected > 0) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            System.out.println("✅ Student updated successfully.");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        System.out.println("❌ Student not found.");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            } catch (SQLException e) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        System.out.println("❌ Error updating student: " + e.getMessage());
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Delete Student
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            public void deleteStudent(int studentID) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    String query = "DELETE FROM Students WHERE studentId = ?";

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         PreparedStatement pstmt = conn.prepareStatement(query)) {

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     pstmt.setInt(1, studentID);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 int rowsAffected = pstmt.executeUpdate();

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             if (rowsAffected > 0) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             System.out.println("✅ Student deleted successfully.");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         System.out.println("❌ Student not found.");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             } catch (SQLException e) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         System.out.println("❌ Error deleting student: " + e.getMessage());
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     }